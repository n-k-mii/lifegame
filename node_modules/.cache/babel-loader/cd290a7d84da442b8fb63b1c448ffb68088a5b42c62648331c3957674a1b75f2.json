{"ast":null,"code":"var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nimport { obtainSlot, optionNullableMemberDecorator } from '../utils';\nexport const decorator = optionNullableMemberDecorator(function (proto, name, key) {\n  const slot = obtainSlot(proto);\n  const map = slot.obtainMap('emit');\n  map.set(name, typeof key === 'undefined' ? null : key);\n});\nexport function build(cons, optionBuilder) {\n  var _a;\n  (_a = optionBuilder.methods) !== null && _a !== void 0 ? _a : optionBuilder.methods = {};\n  const proto = cons.prototype;\n  const slot = obtainSlot(proto);\n  const names = slot.getMap('emit');\n  if (!names || names.size === 0) {\n    return;\n  }\n  const emits = slot.obtainMap('emits');\n  names.forEach((value, key) => {\n    const eventName = value === null ? key : value;\n    emits.set(eventName, true);\n    optionBuilder.methods[key] = function () {\n      return __awaiter(this, arguments, void 0, function* () {\n        const ret = proto[key].apply(this, arguments);\n        if (ret instanceof Promise) {\n          const proRet = yield ret;\n          this.$emit(eventName, proRet);\n        } else if (ret === undefined) {\n          this.$emit(eventName);\n        } else {\n          this.$emit(eventName, ret);\n        }\n      });\n    };\n  });\n}","map":{"version":3,"names":["obtainSlot","optionNullableMemberDecorator","decorator","proto","name","key","slot","map","obtainMap","set","build","cons","optionBuilder","_a","methods","prototype","names","getMap","size","emits","forEach","value","eventName","ret","apply","arguments","Promise","proRet","$emit","undefined"],"sources":["../../../src/option/emit.ts"],"sourcesContent":[null],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,SAASA,UAAU,EAAEC,6BAA6B,QAAQ,UAAU;AAGpE,OAAO,MAAMC,SAAS,GAAGD,6BAA6B,CAAC,UAAUE,KAAU,EAAEC,IAAY,EAAEC,GAAY;EACnG,MAAMC,IAAI,GAAGN,UAAU,CAACG,KAAK,CAAC;EAC9B,MAAMI,GAAG,GAAGD,IAAI,CAACE,SAAS,CAAC,MAAM,CAAC;EAClCD,GAAG,CAACE,GAAG,CAACL,IAAI,EAAE,OAAOC,GAAG,KAAK,WAAW,GAAG,IAAI,GAAGA,GAAG,CAAC;AAC1D,CAAC,CAAC;AAEF,OAAM,SAAUK,KAAKA,CAACC,IAAU,EAAEC,aAA4B;;EAC1D,CAAAC,EAAA,GAAAD,aAAa,CAACE,OAAO,cAAAD,EAAA,cAAAA,EAAA,GAArBD,aAAa,CAACE,OAAO,GAAK,EAAE;EAC5B,MAAMX,KAAK,GAAGQ,IAAI,CAACI,SAAS;EAC5B,MAAMT,IAAI,GAAGN,UAAU,CAACG,KAAK,CAAC;EAC9B,MAAMa,KAAK,GAAGV,IAAI,CAACW,MAAM,CAAC,MAAM,CAAC;EACjC,IAAI,CAACD,KAAK,IAAIA,KAAK,CAACE,IAAI,KAAK,CAAC,EAAE;IAC5B;;EAEJ,MAAMC,KAAK,GAAGb,IAAI,CAACE,SAAS,CAAC,OAAO,CAAC;EACrCQ,KAAK,CAACI,OAAO,CAAC,CAACC,KAAK,EAAEhB,GAAG,KAAI;IACzB,MAAMiB,SAAS,GAAGD,KAAK,KAAK,IAAI,GAAGhB,GAAG,GAAGgB,KAAK;IAC9CF,KAAK,CAACV,GAAG,CAACa,SAAS,EAAE,IAAI,CAAC;IAC1BV,aAAa,CAACE,OAAQ,CAACT,GAAG,CAAC,GAAG;;QAE1B,MAAMkB,GAAG,GAAGpB,KAAK,CAACE,GAAG,CAAC,CAACmB,KAAK,CAAC,IAAI,EAAEC,SAAS,CAAC;QAC7C,IAAIF,GAAG,YAAYG,OAAO,EAAE;UACxB,MAAMC,MAAM,GAAG,MAAMJ,GAAG;UACxB,IAAI,CAACK,KAAK,CAACN,SAAS,EAAEK,MAAM,CAAC;SAChC,MACI,IAAIJ,GAAG,KAAKM,SAAS,EAAE;UACxB,IAAI,CAACD,KAAK,CAACN,SAAS,CAAC;SACxB,MAAM;UACH,IAAI,CAACM,KAAK,CAACN,SAAS,EAAEC,GAAG,CAAC;;MAElC,CAAC;KAAA;EACL,CAAC,CAAC;AAEN"},"metadata":{},"sourceType":"module","externalDependencies":[]}