{"ast":null,"code":"import { obtainSlot, toComponentReverse, excludeNames, getValidNames, optionNullableMemberDecorator } from '../utils';\nexport const HookNames = [\"beforeCreate\", \"created\", \"beforeMount\", \"mounted\", \"beforeUpdate\", \"updated\", \"activated\", \"deactivated\", \"beforeDestroy\", \"beforeUnmount\", \"destroyed\", \"unmounted\", \"renderTracked\", \"renderTriggered\", \"errorCaptured\", \"serverPrefetch\", \"render\"];\nexport const decorator = optionNullableMemberDecorator(function (proto, name) {\n  const slot = obtainSlot(proto);\n  const map = slot.obtainMap('hooks');\n  map.set(name, null);\n});\nexport function build(cons, optionBuilder) {\n  var _a, _b, _c;\n  const slot = obtainSlot(cons.prototype);\n  const protoArr = toComponentReverse(cons.prototype);\n  const map = slot.obtainMap('hooks');\n  (_a = optionBuilder.hooks) !== null && _a !== void 0 ? _a : optionBuilder.hooks = {};\n  (_b = optionBuilder.methods) !== null && _b !== void 0 ? _b : optionBuilder.methods = {};\n  const HookFunctions = {};\n  const MethodFunctions = {};\n  protoArr.forEach(proto => {\n    let names = getValidNames(proto, (des, name) => {\n      return typeof des.value === 'function' && name !== 'constructor';\n    });\n    names = excludeNames(names, slot, mapName => {\n      //include these names:\n      //watch, user may call watch method directly\n      //hooks, user may call hook method directly\n      //emits, user may have a method name which is same as one of event names\n      return !['watch', 'hooks', 'emits', 'provide'].includes(mapName);\n    });\n    names.forEach(name => {\n      if (HookNames.includes(name) || map.has(name)) {\n        HookFunctions[name] = proto[name];\n      } else {\n        MethodFunctions[name] = proto[name];\n      }\n    });\n  });\n  Object.assign(optionBuilder.methods, MethodFunctions);\n  const beforeCreateCallbacks = [...((_c = optionBuilder.beforeCreateCallbacks) !== null && _c !== void 0 ? _c : [])];\n  if (beforeCreateCallbacks && beforeCreateCallbacks.length > 0) {\n    const oldBeforeCreateCallback = HookFunctions['beforeCreate'];\n    HookFunctions['beforeCreate'] = function () {\n      beforeCreateCallbacks.forEach(callback => callback.apply(this, arguments));\n      if (oldBeforeCreateCallback) {\n        oldBeforeCreateCallback.apply(this, arguments);\n      }\n    };\n  }\n  Object.assign(optionBuilder.hooks, HookFunctions);\n}","map":{"version":3,"names":["obtainSlot","toComponentReverse","excludeNames","getValidNames","optionNullableMemberDecorator","HookNames","decorator","proto","name","slot","map","obtainMap","set","build","cons","optionBuilder","prototype","protoArr","_a","hooks","_b","methods","HookFunctions","MethodFunctions","forEach","names","des","value","mapName","includes","has","Object","assign","beforeCreateCallbacks","_c","length","oldBeforeCreateCallback","callback","apply","arguments"],"sources":["../../../src/option/methodsAndHooks.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}